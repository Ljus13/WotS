<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roleplay Box Generator (Vue 3 + Quill)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&family=Prompt:wght@300;400;600&family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- FontAwesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <!-- Quill.js (Rich Text Editor) CDN -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>

    <!-- Original CSS for 100% Accurate Live Preview -->
    <link href="https://savant777.github.io/zoecode/theresume.css" rel="stylesheet">

    <style>
        body {
            font-family: 'Prompt', sans-serif;
            background-color: #0f172a; 
            color: #f8fafc;
        }

        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { width: 8px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #1e293b; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #64748b; }

        /* Color & Range Input Styling */
        input[type="color"] {
            -webkit-appearance: none;
            border: none;
            width: 100%;
            height: 40px;
            border-radius: 0.375rem;
            cursor: pointer;
            padding: 0;
            background: transparent;
        }
        input[type="color"]::-webkit-color-swatch-wrapper { padding: 0; }
        input[type="color"]::-webkit-color-swatch { border: 2px solid #334155; border-radius: 0.375rem; }
        input[type="range"] { accent-color: #6366f1; }

        /* Toast Animation */
        .toast-enter-active, .toast-leave-active { transition: all 0.3s ease; }
        .toast-enter-from, .toast-leave-to { transform: translateY(100%); opacity: 0; }

        /* Quill Editor Dark Theme Overrides */
        .ql-toolbar.ql-snow {
            border-color: #475569; background-color: #1e293b;
            border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem;
        }
        .ql-container.ql-snow {
            border-color: #475569; background-color: #0f172a;
            border-bottom-left-radius: 0.5rem; border-bottom-right-radius: 0.5rem;
            color: #e2e8f0; min-height: 150px; font-family: 'Prompt', sans-serif;
        }
        .ql-snow .ql-stroke { stroke: #cbd5e1; }
        .ql-snow .ql-fill, .ql-snow .ql-stroke.ql-fill { fill: #cbd5e1; }
        .ql-snow .ql-picker { color: #cbd5e1; }
        .ql-snow .ql-picker-options { background-color: #1e293b; border-color: #475569; }
        .ql-snow .ql-tooltip { background-color: #1e293b; color: #fff; border-color: #475569; }
        
        /* Quill Custom Font Sizes Labeling */
        .ql-snow .ql-picker.ql-size .ql-picker-label[data-value]::before,
        .ql-snow .ql-picker.ql-size .ql-picker-item[data-value]::before {
            content: attr(data-value) !important;
        }
        .ql-snow .ql-picker.ql-size .ql-picker-label:not([data-value])::before,
        .ql-snow .ql-picker.ql-size .ql-picker-item:not([data-value])::before {
            content: '16px' !important; /* Default Text */
        }

        /* Dynamic Highlight format for Quill Editor */
        .ql-editor .rsmhl {
            background-color: var(--dyn-main-color, #888);
            color: var(--dyn-txt-highlight, #181818);
            padding: 0 0.25rem;
            font-weight: bold;
            border-radius: 2px;
        }

        /* Restore HTML formatting inside preview reset by Tailwind */
        .preview-content b, .preview-content strong { font-weight: bold; }
        .preview-content i, .preview-content em { font-style: italic; }
        .preview-content u { text-decoration: underline; }
        .preview-content p { margin-bottom: 0.5em; }

        /* ====== NEW SCALING LOGIC ====== */
        #preview-container {
            position: relative;
            width: 100%;
        }

        /* บังคับให้แสดงผลแบบ Desktop 100% เสมอในกล่อง Preview เพื่อให้ย่อสัดส่วนได้ตรงเป๊ะ (ไม่ให้ Responsive แทรกแซง) */
        #preview-scale-wrapper .rsmbox {
            max-width: none !important;
            padding: 5rem !important;
        }
        #preview-scale-wrapper .rsmpic {
            width: 200px !important;
            height: 200px !important;
        }
    </style>
</head>
<body>

<div id="app" class="h-screen flex flex-col overflow-hidden" :style="{ '--dyn-main-color': form.main, '--dyn-txt-highlight': form.hl }">
    <!-- Header -->
    <header class="bg-slate-800 border-b border-slate-700 p-4 shadow-md flex justify-between items-center shrink-0">
        <div class="flex items-center gap-3">
            <i class="fa-solid fa-wand-magic-sparkles text-indigo-400 text-2xl"></i>
            <h1 class="text-xl font-semibold tracking-wide">Roleplay Box <span class="text-indigo-400">Generator</span></h1>
        </div>
        <div class="flex items-center gap-4">
            <!-- ส่วนแสดงเครดิต -->
            <div class="hidden sm:flex flex-col text-right text-xs text-slate-400 border-r border-slate-600 pr-4">
                <span>Generator by <a href="https://discord.com/users/306461697470627840" target="_blank" class="text-indigo-400 hover:text-indigo-300 font-medium transition-colors">Kendrick Mervin</a></span>
                <span>Design by <a href="https://discord.com/users/625292873914515456/" target="_blank" class="text-emerald-400 hover:text-emerald-300 font-medium transition-colors">zzzcode</a></span>
            </div>
            
            <button @click="resetData" class="text-xs text-slate-400 hover:text-rose-400 transition-colors border border-slate-600 hover:border-rose-400 px-3 py-1 rounded-full flex items-center gap-1" title="ล้างข้อมูลที่บันทึกไว้">
                <i class="fa-solid fa-rotate-right"></i> รีเซ็ต
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col lg:flex-row overflow-hidden">
        
        <!-- Left Panel (Top Panel on Mobile): Input Form -->
        <aside class="w-full h-1/2 lg:h-full lg:w-[500px] bg-slate-800/50 p-6 overflow-y-auto custom-scrollbar border-b lg:border-b-0 lg:border-r border-slate-700 shrink-0">
            <div class="space-y-6">
                
                <!-- Section: Layout & Colors -->
                <div class="bg-slate-800 p-4 rounded-xl shadow-sm border border-slate-700">
                    <h2 class="text-lg font-medium mb-4 flex items-center gap-2 text-indigo-300">
                        <i class="fa-solid fa-palette"></i> เลย์เอาต์และสี (Layout & Colors)
                    </h2>
                    
                    <div class="mb-4 bg-slate-900 p-3 rounded-lg border border-slate-700">
                        <label class="flex justify-between text-xs text-slate-400 mb-2">
                            <span>ความกว้างกล่อง (Width)</span>
                            <span class="text-indigo-400">{{ form.width }}px</span>
                        </label>
                        <input type="range" v-model="form.width" min="300" max="1200" step="10" class="w-full">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">สีพื้นหลัง (Background)</label>
                            <div class="flex items-center gap-2">
                                <input type="color" v-model="form.bg">
                                <span class="text-xs text-slate-300 font-mono w-16">{{ form.bg }}</span>
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">สีตัวอักษร (Text)</label>
                            <div class="flex items-center gap-2">
                                <input type="color" v-model="form.txt">
                                <span class="text-xs text-slate-300 font-mono w-16">{{ form.txt }}</span>
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">สีเส้นขอบ (Border)</label>
                            <div class="flex items-center gap-2">
                                <input type="color" v-model="form.border">
                                <span class="text-xs text-slate-300 font-mono w-16">{{ form.border }}</span>
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs text-slate-400 mb-1">สีหลัก (Main Color)</label>
                            <div class="flex items-center gap-2">
                                <input type="color" v-model="form.main">
                                <span class="text-xs text-slate-300 font-mono w-16">{{ form.main }}</span>
                            </div>
                        </div>
                        <div class="col-span-2">
                            <label class="block text-xs text-slate-400 mb-1">สีตัวหนังสือไฮไลท์ (Highlight Text)</label>
                            <div class="flex items-center gap-2">
                                <input type="color" v-model="form.hl">
                                <span class="text-xs text-slate-300 font-mono w-16">{{ form.hl }}</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section: Profile & Font -->
                <div class="bg-slate-800 p-4 rounded-xl shadow-sm border border-slate-700 space-y-4">
                    <h2 class="text-lg font-medium flex items-center gap-2 text-emerald-300">
                        <i class="fa-solid fa-image"></i> โปรไฟล์และรูปภาพ
                    </h2>
                    <div>
                        <label class="block text-xs text-slate-400 mb-1">ลิงก์รูปภาพ (Image URL)</label>
                        <input type="text" v-model="form.pic" class="w-full bg-slate-900 border border-slate-600 rounded-lg p-2.5 text-sm focus:outline-none focus:border-indigo-500 transition-colors" placeholder="https://...">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 p-3 bg-slate-900 rounded-lg border border-slate-700">
                        <div class="col-span-2 sm:col-span-1">
                            <label class="block text-xs text-slate-400 mb-1">ขนาดภาพ (Image Size)</label>
                            <select v-model="form.picSz" class="w-full bg-slate-800 border border-slate-600 rounded-lg p-2 text-sm focus:outline-none focus:border-indigo-500">
                                <option value="cover">พอดีกรอบ (Cover)</option>
                                <option value="contain">แสดงเต็มภาพ (Contain)</option>
                                <option value="100% 100%">บีบให้พอดี (100% 100%)</option>
                                <option value="auto">ขนาดดั้งเดิม (Auto)</option>
                            </select>
                        </div>
                        <div class="col-span-2 sm:col-span-1">
                            <label class="block text-xs text-slate-400 mb-1">รูปแบบอักษร (Font)</label>
                            <select v-model="form.font" class="w-full bg-slate-800 border border-slate-600 rounded-lg p-2 text-sm focus:outline-none focus:border-indigo-500">
                                <option value="Kanit">Kanit</option>
                                <option value="Prompt">Prompt</option>
                                <option value="Sarabun">Sarabun</option>
                                <option value="Tahoma">Tahoma</option>
                                <option value="Courier New">Courier New</option>
                            </select>
                        </div>
                        <div class="col-span-2">
                            <label class="flex justify-between text-xs text-slate-400 mb-2">
                                <span>เลื่อนแกน X (ซ้าย-ขวา)</span>
                                <span class="text-indigo-400">{{ form.picPosX }}%</span>
                            </label>
                            <input type="range" v-model="form.picPosX" min="0" max="100" class="w-full">
                        </div>
                        <div class="col-span-2">
                            <label class="flex justify-between text-xs text-slate-400 mb-2">
                                <span>เลื่อนแกน Y (บน-ล่าง)</span>
                                <span class="text-indigo-400">{{ form.picPosY }}%</span>
                            </label>
                            <input type="range" v-model="form.picPosY" min="0" max="100" class="w-full">
                        </div>
                    </div>

                    <div>
                        <label class="block text-xs text-slate-400 mb-1">ชื่อ (Name)</label>
                        <input type="text" v-model="form.name" class="w-full bg-slate-900 border border-slate-600 rounded-lg p-2.5 text-sm focus:outline-none focus:border-indigo-500 transition-colors" placeholder="ใส่ชื่อตัวละคร">
                    </div>
                </div>

                <!-- Section: Content -->
                <div class="bg-slate-800 p-4 rounded-xl shadow-sm border border-slate-700 space-y-4">
                    <h2 class="text-lg font-medium flex items-center gap-2 text-amber-300">
                        <i class="fa-solid fa-align-left"></i> เนื้อหา
                    </h2>
                    <div>
                        <label class="flex justify-between items-end text-xs text-slate-400 mb-1">
                            <span>ข้อความหลัก (Main Text)</span>
                            <span class="text-indigo-400"><i class="fa-solid fa-highlighter mr-1"></i>พร้อมไฮไลต์</span>
                        </label>
                        <!-- Quill Editor Container -->
                        <div id="editor-container"></div>
                    </div>
                    <div>
                        <label class="block text-xs text-slate-400 mb-1">ข้อความในหมายเหตุ (Note)</label>
                        <input type="text" v-model="form.note" class="w-full bg-slate-900 border border-slate-600 rounded-lg p-2.5 text-sm focus:outline-none focus:border-indigo-500 transition-colors" placeholder="ข้อความหมายเหตุ">
                    </div>
                </div>

            </div>
        </aside>

        <!-- Right Panel (Bottom Panel on Mobile): Preview & Actions -->
        <section class="flex-1 flex flex-col bg-[#09090b] relative h-1/2 lg:h-full">
            
            <!-- Live Preview Area -->
            <div class="flex-1 overflow-x-hidden overflow-y-auto custom-scrollbar p-4 lg:p-8" id="preview-wrapper">
                <div class="text-center text-slate-500 text-sm mb-6 uppercase tracking-widest"><i class="fa-solid fa-eye mr-2"></i>Live Preview</div>
                
                <!-- Container สำหรับรองรับการย่อส่วนด้วย Scale -->
                <div id="preview-container" :style="outerHeightStyle" class="transition-[height] duration-200 ease-out">
                    <div id="preview-scale-wrapper" :style="previewScaleStyle" ref="innerWrapperRef">
                        <!-- โค้ดที่เรนเดอร์ออกมาจริง -->
                        <div id="zzzcode">
                            <a href="https://discord.com/users/625292873914515456/"></a>
                            <!-- Applying CSS Custom Properties exactly like the final code -->
                            <div class="rsmbox" :style="{ 
                                width: form.width + 'px', 
                                '--rsm-bg-color': form.bg, 
                                '--rsm-txt-color': form.txt, 
                                '--rsm-border': form.border, 
                                '--rsm-main-color': form.main, 
                                '--rsm-txt-highlight': form.hl, 
                                fontFamily: `'${form.font}'` 
                            }">
                                <div class="rsmpic" :style="{ 
                                    '--rsm-pic': `url('${form.pic}')`, 
                                    '--rsm-pos': `${form.picPosX}% ${form.picPosY}%`,
                                    '--rsm-sz': form.picSz
                                }"></div>
                                <div class="rsmname" :style="{ fontFamily: `'${form.font}'` }">{{ form.name }}</div>
                                <hr>
                                
                                <!-- Content generated by Quill Editor -->
                                <div class="preview-content" v-html="form.msgHTML"></div>
                                
                                <hr>
                                <span class="rsmhl">หมายเหตุ</span> {{ form.note }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Bar -->
            <div class="bg-slate-800 border-t border-slate-700 p-4 lg:p-6 shadow-lg flex flex-col sm:flex-row justify-between items-center gap-4 shrink-0">
                <div class="text-xs lg:text-sm text-slate-400 text-center sm:text-left">
                    <i class="fa-solid fa-code text-indigo-400 mr-1"></i> โค้ดจะถูกแปลงเป็น Single Line พร้อมนำไปใช้งานอัตโนมัติ
                </div>
                <button @click="copyCodeToClipboard" class="w-full sm:w-auto bg-indigo-600 hover:bg-indigo-500 text-white font-semibold py-3 px-8 rounded-xl shadow-lg hover:shadow-indigo-500/30 transition-all duration-300 flex items-center justify-center gap-3 active:scale-95">
                    <i class="fa-regular fa-copy text-lg"></i>
                    <span>คัดลอกโค้ดโรลเพลย์</span>
                </button>
            </div>
        </section>
    </main>

    <!-- Toast Notification -->
    <Transition name="toast">
        <div v-if="showToast" class="fixed bottom-24 right-8 bg-emerald-500 text-white px-6 py-3 rounded-lg shadow-xl flex items-center gap-3 z-50">
            <i class="fa-solid fa-check-circle text-xl"></i>
            <div>
                <h4 class="font-bold">คัดลอกสำเร็จ!</h4>
                <p class="text-sm text-emerald-100">นำโค้ดไปวางในพื้นที่ที่ต้องการได้เลย</p>
            </div>
        </div>
    </Transition>
</div>

<script>
    const { createApp, ref, reactive, onMounted, watch, onUnmounted, computed, nextTick } = Vue;

    createApp({
        setup() {
            const STORAGE_KEY = 'roleplay-box-data';
            
            // ค่าเริ่มต้น
            const defaultData = {
                width: 800,
                bg: '#101010',
                txt: '#e5e5e5',
                border: '#333333',
                main: '#888888',
                hl: '#181818',
                pic: 'https://picsum.photos/200',
                picSz: 'cover',
                picPosX: 50,
                picPosY: 50,
                name: 'นามสมมติ ตัวละคร',
                font: 'Prompt',
                note: 'โรลเพลย์นี้เป็นการจำลองสถานการณ์เท่านั้น',
                msgHTML: '<p>แสงจันทร์สาดส่องลงมาสะท้อนกับผิวน้ำที่นิ่งสงบ...</p><p>ชายหนุ่ม <span class="rsmhl">ค่อยๆ ก้าวเดิน</span> ออกไปข้างหน้าอย่างช้าๆ</p>'
            };

            // โหลดข้อมูลจาก LocalStorage (ถ้ามี)
            let initialData = defaultData;
            try {
                const saved = localStorage.getItem(STORAGE_KEY);
                if (saved) {
                    initialData = { ...defaultData, ...JSON.parse(saved) };
                }
            } catch (e) {
                console.error('Failed to load local storage', e);
            }

            // Reactive State
            const form = reactive(initialData);

            // บันทึกอัตโนมัติเมื่อมีการเปลี่ยนแปลงค่าใน form
            watch(form, (newVal) => {
                localStorage.setItem(STORAGE_KEY, JSON.stringify(newVal));
            }, { deep: true });

            const showToast = ref(false);
            let quillEditor = null;

            // ==========================================
            // ระบบ Scale หน้าจอ Preview สำหรับหน้าจอขนาดเล็ก
            // ==========================================
            const wrapperWidth = ref(0);
            const innerHeight = ref(0);
            const innerWrapperRef = ref(null);
            let ro = null;

            // คำนวณหาความกว้างของพื้นที่ Preview
            const updateDimensions = () => {
                const container = document.getElementById('preview-container');
                if (container) {
                    wrapperWidth.value = container.clientWidth;
                }
            };

            // คำนวณอัตราส่วน (ถ้ายิ่งกล่องใหญ่กว่าจอ ก็ยิ่งต้องย่อให้เล็กลง)
            const scale = computed(() => {
                const boxWidth = Number(form.width) || 800;
                if (wrapperWidth.value > 0 && wrapperWidth.value < boxWidth) {
                    return wrapperWidth.value / boxWidth;
                }
                return 1;
            });

            // สไตล์สำหรับใช้ย่อสัดส่วนกล่องให้อยู่ตรงกลางเสมอ
            const previewScaleStyle = computed(() => {
                const boxWidth = Number(form.width) || 800;
                const scaledWidth = boxWidth * scale.value;
                const offsetLeft = (wrapperWidth.value - scaledWidth) / 2;
                
                return {
                    width: boxWidth + 'px',
                    transform: `scale(${scale.value})`,
                    transformOrigin: 'top left',
                    position: 'absolute',
                    left: Math.max(0, offsetLeft) + 'px',
                    top: '0'
                };
            });

            // ปรับความสูงของกล่องภายนอกให้ล้อตามความสูงที่ถูก Scale แล้ว (ป้องกันพื้นที่ว่างล้น)
            const outerHeightStyle = computed(() => {
                if (innerHeight.value === 0) return { minHeight: '400px' };
                return { height: (innerHeight.value * scale.value) + 'px' };
            });

            onMounted(() => {
                // Initialize Scale System
                window.addEventListener('resize', updateDimensions);
                
                // Set Up Resize Observer จับความสูงกล่องเวลามีการพิมพ์ข้อความเพิ่ม
                nextTick(() => {
                    updateDimensions();
                    ro = new ResizeObserver(() => {
                        if (innerWrapperRef.value) {
                            innerHeight.value = innerWrapperRef.value.offsetHeight;
                        }
                    });
                    if (innerWrapperRef.value) {
                        ro.observe(innerWrapperRef.value);
                    }
                });

                // Configure Quill to output inline styles
                const ColorStyle = Quill.import('attributors/style/color');
                Quill.register(ColorStyle, true);
                
                // Set specific font sizes mapped to pixels
                const SizeStyle = Quill.import('attributors/style/size');
                SizeStyle.whitelist = ['12px', '14px', '16px', '18px', '24px'];
                Quill.register(SizeStyle, true);

                // สร้าง Custom Format สำหรับ rsmhl (ไฮไลต์)
                const Inline = Quill.import('blots/inline');
                class RsmHighlight extends Inline {
                    static create(value) { return super.create(value); }
                    static formats(node) { return true; }
                }
                RsmHighlight.blotName = 'rsmhl';
                RsmHighlight.tagName = 'span';
                RsmHighlight.className = 'rsmhl';
                Quill.register(RsmHighlight, true);

                const icons = Quill.import('ui/icons');
                icons['rsmhl'] = '<svg viewbox="0 0 18 18"><path class="ql-fill" d="M10.89 2.11L15.89 7.11L7 16L2 11L10.89 2.11ZM3.41 11.59L7.41 15.59L15.18 7.82L11.18 3.82L3.41 11.59ZM2 16H6L2.5 12.5L2 16Z"/></svg>'; 

                quillEditor = new Quill('#editor-container', {
                    theme: 'snow',
                    placeholder: 'พิมพ์ข้อความโรลเพลย์ที่นี่...',
                    modules: {
                        toolbar: {
                            container: [
                                [{ 'size': SizeStyle.whitelist }],
                                ['bold', 'italic', 'underline'],
                                ['rsmhl'], 
                                [{ 'color': [] }],
                                ['clean']
                            ],
                            handlers: {
                                'rsmhl': function() {
                                    const range = this.quill.getSelection();
                                    if (range) {
                                        const format = this.quill.getFormat(range);
                                        this.quill.format('rsmhl', !format.rsmhl);
                                    }
                                }
                            }
                        }
                    }
                });

                quillEditor.root.innerHTML = form.msgHTML;

                quillEditor.on('text-change', () => {
                    form.msgHTML = quillEditor.root.innerHTML;
                });
            });

            onUnmounted(() => {
                window.removeEventListener('resize', updateDimensions);
                if (ro) ro.disconnect();
            });

            // สร้างและคัดลอกโค้ด
            const copyCodeToClipboard = () => {
                const fontLink = `<link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&family=Prompt:wght@300;400;600&family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">`;
                
                const rawCode = `${fontLink}
<link href="https://savant777.github.io/zoecode/theresume.css" rel="stylesheet">
<div id="zzzcode"><a href="https://discord.com/users/625292873914515456/"></a><div class="rsmbox" style="width: ${form.width}px;--rsm-bg-color: ${form.bg};--rsm-txt-color: ${form.txt};--rsm-border: ${form.border};--rsm-main-color: ${form.main};--rsm-txt-highlight: ${form.hl};font-family: '${form.font}';">
<div class="rsmpic" style="--rsm-pic: url(${form.pic});--rsm-pos: ${form.picPosX}% ${form.picPosY}%;--rsm-sz: ${form.picSz};"></div>
<div class="rsmname" style="font-family: '${form.font}';">${form.name}</div>
<hr>
${form.msgHTML}
<hr>
<span class="rsmhl">หมายเหตุ</span> ${form.note}
</div></div>`;

                const singleLineCode = rawCode.replace(/[\r\n]+/g, '');

                const tempTextArea = document.createElement("textarea");
                tempTextArea.value = singleLineCode;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                
                try {
                    document.execCommand('copy');
                    showToast.value = true;
                    setTimeout(() => { showToast.value = false; }, 3000);
                } catch (err) {
                    console.error('Failed to copy text', err);
                    alert("เกิดข้อผิดพลาดในการคัดลอก กรุณาลองใหม่");
                }
                
                document.body.removeChild(tempTextArea);
            };

            const resetData = () => {
                if(confirm('คุณต้องการล้างข้อมูลที่พิมพ์ไว้ทั้งหมดและกลับไปใช้ค่าเริ่มต้นใช่หรือไม่?')) {
                    localStorage.removeItem(STORAGE_KEY);
                    window.location.reload();
                }
            };

            return {
                form,
                showToast,
                copyCodeToClipboard,
                resetData,
                innerWrapperRef,
                previewScaleStyle,
                outerHeightStyle
            };
        }
    }).mount('#app');
</script>
</body>
</html>